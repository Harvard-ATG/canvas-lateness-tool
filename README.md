# canvas-lateness-tool
Exports and aggregates late student submission data


## Quickstart

Setup [python virtual environment](http://docs.python-guide.org/en/latest/dev/virtualenvs/):

```sh
$ virtualenv pyenv
$ source pyenv/bin/activate
$ pip install -r requirements.txt
```

Setup environment settings needed to interact with the canvas API. In particular, you need to obtain and set your `OAUTH_TOKEN` in the `.env` file. To obtain a token, go to [your Canvas profile](https://canvas.harvard.edu/profile) and navigate to your [profile settings](https://canvas.harvard.edu/profile/settings). At the bottom of the settings page, you should see a button to create a **New Access Token**. When you click the button, it should open a dialog containing an access token. Copy and paste this value into your `.env` file such that `OAUTH_TOKEN="your_access_token"`.

```sh
$ cp -v .env.example .env
$ nano .env
```

At this point you should have all required python dependencies and the required environment settings.

To run the script with your canvas course ID:

```sh
$ python canvas_lateness.py
usage: canvas_lateness.py [-h] [--use_cache] [--debug] course_id
```

The script will generate several output files, the most interesting of which is an Excel spreadsheet containing the results.

##Excel Export

The excel spreadsheet generated by the script will have two worksheets, the first of which contains the delta time for each student's assignment, and the second of which contains the total accumulated lateness across all of their submissions. Note that assignments will only be included if they meet the following criteria:

1. The assignment has a due date.
2. The assignment has at least one submission.

Example format of the worksheets:

### Sheet 1

| Assignment  | Week 1 Assignment    |                      |                 | Week 2 Assignment    |                      |                 |
|-------------|----------------------|----------------------|-----------------|----------------------|----------------------|-----------------|
| Students    | Due                  | Submitted            | Delta (seconds) | Due                  | Submitted            | Delta (seconds) |
| Last, First | 2016-04-12T03:59:00Z | 2016-04-12T18:47:08Z | 53288           | 2016-05-10T03:59:00Z | 2016-05-10T00:54:33Z | -11067          |
|             |                      |                      |                 |                      |                      |                 |

### Sheet 2

| Students    | Total (compact) | Total (hours) | Total (seconds) |
|-------------|-----------------|---------------|-----------------|
| Last, First | 2d83414s        | 71            | 256214          |
|             |                 |               |                 |
